var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},n3Charts;!function(a){var b;!function(a){"use strict";function b(){function a(a,b,c){a.attr("transform",function(a){var d=b(a.value);return"translate("+(isFinite(d)?d:c(a.value))+",0)"})}function b(a,b,c){a.attr("transform",function(a){var d=b(a.value);return"translate(0,"+(isFinite(d)?d:c(a.value))+")"})}function c(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function d(a){return a.rangeExtent?a.rangeExtent():c(a.range())}var e,f=([].slice,"bottom"),g={top:1,right:1,bottom:1,left:1},h=d3.scale.linear(),i=f,j=6,k=24,l=-6,m=0,n=5,o=null,p=null,q=function(c,f,g,h,o){var p,q="major"===f,r=q?k:m,s=q?l:n,t=o.selectAll(".tick."+f).data(c,function(a){return h(a.value)}),u=t.enter().insert("g",".domain").attr("class","tick "+f).style("opacity",1e-6),v=d3.transition(t.exit()).style("opacity",1e-6).remove(),w=d3.transition(t.order()).style("opacity",1),x=Math.max(r,0)+s,y=d(h),z=o.selectAll(".domain").data([0]),A=(z.enter().append("path").attr("class","domain"),z.transition());u.append("line"),u.append("text");var B,C,D,E,F=u.select("line"),G=w.select("line"),H=t.select("text").text(function(a,b){return e?e(a,b):a.label}),I=u.select("text"),J=w.select("text"),K="top"===i||"left"===i?-1:1;"bottom"===i||"top"===i?(p=a,B="x",D="y",C="x2",E="y2",H.attr({dy:0>K?"0em":".8em",dx:"5px"}).style("text-anchor","left"),A.attr("d","M"+y[0]+","+K*j+"V0H"+y[1]+"V"+K*j)):(p=b,B="y",D="x",C="y2",E="x2",H.attr({dy:".32em",dx:0>K?-x+"px":x+"px"}).style("text-anchor",0>K?"end":"start"),A.attr("d","M"+K*j+","+y[0]+"H0V"+y[1]+"H"+K*j)),F.attr(E,K*r),I.attr(D,K*x),G.attr(C,0).attr(E,K*r),J.attr(B,0).attr(D,K*x),v.call(p,h,g),u.call(p,g,h),w.call(p,h,h)},r=function(a){a.each(function(){var a=d3.select(this),b=this.__chart__||h,c=this.__chart__=h.copy(),d=o(c.domain()),e=d.major,f=d.minor;q(e,"major",b,c,a),q(f,"minor",b,c,a)})};return r.scale=function(a){return arguments.length?(h=a,r):h},r.orient=function(a){return arguments.length?(i=a in g?a+"":f,r):i},r.ticks=function(a){return arguments.length?(o=a,r):o},r.tickValues=function(a){return arguments.length?(p=a,r):p},r.tickFormat=function(a){return arguments.length?(e=a,r):e},r.tickSize=function(a){var b=arguments.length;return b?(k=+a,j=+arguments[b-1],m=+a,r):k},r.innerTickSize=function(a){return arguments.length?(k=+a,r):k},r.outerTickSize=function(a){return arguments.length?(j=+a,r):j},r.tickPadding=function(a){return arguments.length?(l=+a,r):l},r}a.twoSpeedAxis=b}(b=a.svg||(a.svg={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){"use strict";var c=function(){function c(b){void 0===b&&(b={}),this.axis="y",this.type=["line"],this.visible=!0,this.defined=function(a){return!0};var c=this.sanitizeOptions(b);this.id=c.id||a.Utils.UUID.generate(),this.axis=c.axis,this.interpolation=c.interpolation,this.dataset=c.dataset,this.key=c.key,this.color=c.color,this.visible=c.visible,this.label=c.label||c.id,c.defined&&(this.defined=c.defined),c.type.length>0&&(this.type=this.sanitizeType(c.type))}return c.prototype.sanitizeOptions=function(a){var c={};return angular.extend(c,this,a),c.axis=this.sanitizeAxis(c.axis),c.interpolation=this.sanitizeInterpolation(c.interpolation),c.id=b.Options.getString(c.id),c.type=b.Options.getArray(c.type),c.dataset=b.Options.getString(c.dataset),c.key=this.sanitizeKeys(c.key),c.color=b.Options.getString(c.color),c.label=b.Options.getString(c.label),c.visible=b.Options.getBoolean(c.visible),c.defined=b.Options.getFunction(c.defined),c},c.prototype.sanitizeInterpolation=function(a){return a?{mode:b.Options.getString(a.mode,"linear"),tension:b.Options.getNumber(a.tension,.7)}:{mode:"linear",tension:.7}},c.prototype.sanitizeKeys=function(a){return a?"string"==typeof a?{y1:b.Options.getString(a)}:{y0:b.Options.getString(a.y0),y1:b.Options.getString(a.y1)}:{y1:void 0}},c.prototype.getToggledVisibility=function(){return!this.visible},c.prototype.sanitizeType=function(a){return a.filter(function(a){return c.isValidType(a)?!0:(console.warn("Unknow series type : "+a),!1)})},c.prototype.sanitizeAxis=function(a){if(-1===["y","y2"].indexOf(a))throw TypeError(a+" is not a valid series option for axis.");return a},c.prototype.isAColumn=function(){return this.hasType(c.TYPE.COLUMN)},c.prototype.isDashed=function(){return-1!==this.type.indexOf(c.TYPE.DASHED_LINE)},c.prototype.hasType=function(a){return a===c.TYPE.LINE?-1!==this.type.indexOf(a)||-1!==this.type.indexOf(c.TYPE.DASHED_LINE):-1!==this.type.indexOf(a)},c.prototype.hasTwoKeys=function(){return void 0!==this.key.y0},c.isValidType=function(a){return-1!==d3.values(c.TYPE).indexOf(a)},c.TYPE={DOT:"dot",LINE:"line",DASHED_LINE:"dashed-line",AREA:"area",COLUMN:"column"},c}();b.SeriesOptions=c}(b=a.Options||(a.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function b(a){void 0===a&&(a={}),this.includeZero=!1,this.type="linear",this.key="x",this.padding={min:0,max:0},this.ticksShift={x:0,y:0},this.parse(a)}return b.prototype.parse=function(c){this.type=a.Options.getString(c.type,"linear"),this.key=c.key,this.padding=a.Options.getObject(c.padding||{},this.padding),this.includeZero=a.Options.getBoolean(c.includeZero,!1),this.tickFormat=a.Options.getFunction(c.tickFormat),this.ticks=c.ticks,c.ticksShift&&(this.ticksShift={x:a.Options.getNumber(c.ticksShift.x,0),y:a.Options.getNumber(c.ticksShift.y,0)}),this.type===b.TYPE.LINEAR?(this.min=a.Options.getNumber(c.min,void 0),this.max=a.Options.getNumber(c.max,void 0)):this.type===b.TYPE.DATE&&(this.min=a.Options.getDate(c.min,void 0),this.max=a.Options.getDate(c.max,void 0))},b.isValidSide=function(a){return-1!==d3.values(b.SIDE).indexOf(a)},b.prototype.hasDynamicTicks=function(){return this.ticks instanceof Function},b.prototype.configure=function(a){return a.tickFormat(this.tickFormat),this.ticks instanceof Array?a.tickValues(this.ticks):"number"==typeof this.ticks?a.ticks(this.ticks):this.ticks instanceof Function&&a.ticks(this.ticks),a},b.SIDE={X:"x",X2:"x2",Y:"y",Y2:"y2"},b.TYPE={LINEAR:"linear",DATE:"date",LOG:"log"},b}();a.AxisOptions=b}(b=a.Options||(a.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function b(){this.width=600,this.height=200,this.innerWidth=560,this.innerHeight=160,this.margin=b.getDefaultMargins()}return b.getDefaultMargins=function(){return{top:0,left:40,bottom:40,right:40}},b.prototype.updateMargins=function(b){var c=this;if(b&&b.margin){var d=function(d){return c.margin[d]=a.Options.getNumber(b.margin[d],c.margin[d])};d("top"),d("bottom"),d("left"),d("right")}},b.prototype.getDimensionByProperty=function(a,b){var c=window.getComputedStyle(a,null);return+c.getPropertyValue(b).replace(/px$/,"")},b.prototype.fromParentElement=function(a){if(a){var b=this.getDimensionByProperty(a,"padding-left")+this.getDimensionByProperty(a,"padding-right"),c=this.getDimensionByProperty(a,"padding-top")+this.getDimensionByProperty(a,"padding-bottom");this.width=a.clientWidth-b,this.height=a.clientHeight-c,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right}},b}();a.Dimensions=b}(b=a.Options||(a.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function b(c){this.doubleClickEnabled=!0,this.series=[],this.pan={x:!1,y:!1},this.zoom={x:!1,y:!1},this.axes={x:{},y:{}},this.margin=a.Dimensions.getDefaultMargins(),this.grid={x:!1,y:!0};var d=angular.extend({},this,c);this.margin=this.sanitizeMargin(b.getObject(d.margin,this.margin)),this.series=this.sanitizeSeries(b.getArray(d.series)),this.axes=this.sanitizeAxes(b.getObject(d.axes,this.axes)),this.grid=this.sanitizeTwoAxesOptions(d.grid,this.grid),this.pan=this.sanitizeTwoAxesOptions(d.pan,this.pan),this.zoom=this.sanitizeTwoAxesOptions(d.zoom,this.zoom),this.tooltipHook=b.getFunction(d.tooltipHook),this.doubleClickEnabled=b.getBoolean(d.doubleClickEnabled,!1)}return b.prototype.sanitizeMargin=function(a){return{top:b.getNumber(a.top,0),left:b.getNumber(a.left,0),bottom:b.getNumber(a.bottom,0),right:b.getNumber(a.right,0)}},b.prototype.sanitizeSeries=function(b){return b.map(function(b){return new a.SeriesOptions(b)})},b.prototype.sanitizeTwoAxesOptions=function(a,c){var d={x:b.getBoolean(a.x,c.x),y:b.getBoolean(a.y,c.y)};return d},b.prototype.sanitizeAxes=function(b){return Object.keys(b).reduce(function(c,d){return c[d]=new a.AxisOptions(b[d]),c},{})},b.prototype.getAbsKey=function(){if(!this.axes[a.AxisOptions.SIDE.X])throw new TypeError("Cannot find abs key : "+a.AxisOptions.SIDE.X);return this.axes[a.AxisOptions.SIDE.X].key},b.prototype.getVisibleDatasets=function(){var a=[];return this.series.forEach(function(b){b.visible&&-1===a.indexOf(b.dataset)&&a.push(b.dataset)}),a},b.prototype.getSeriesAndDatasetBySide=function(b){if(!a.AxisOptions.isValidSide(b))throw new TypeError("Cannot get axis side : "+b);b!==a.AxisOptions.SIDE.Y2||this.axes[b]||(b=a.AxisOptions.SIDE.Y);var c=[],d={};return this.series.forEach(function(a){a.visible&&a.axis===b&&(c.push(a.dataset),d[a.dataset]||(d[a.dataset]=[]),d[a.dataset].push(a))}),{seriesForDataset:d,datasetsForSide:c}},b.prototype.getByAxisSide=function(b){if(!a.AxisOptions.isValidSide(b))throw new TypeError("Cannot get axis side : "+b);if(!this.axes[b]){if(b===a.AxisOptions.SIDE.Y2)return this.axes[a.AxisOptions.SIDE.Y];if(b===a.AxisOptions.SIDE.X2)return this.axes[a.AxisOptions.SIDE.X]}return this.axes[b]},b.prototype.getSeriesByType=function(b){if(!a.SeriesOptions.isValidType(b))throw new TypeError("Unknown series type: "+b);return this.series.filter(function(a){return a.hasType(b)})},b.getBoolean=function(a,b){return void 0===b&&(b=!0),"boolean"==typeof a?a:b},b.getNumber=function(a,b){var c=parseFloat(a);return isNaN(c)?b:c},b.getDate=function(a,b){return a instanceof Date?a:b},b.getFunction=function(a){return a instanceof Function?a:void 0},b.getString=function(a,b){return a?String(a):b},b.getIdentifier=function(a){var c=b.getString(a);return c.replace(/[^a-zA-Z0-9\-_]/gi,"")},b.getObject=function(a,b){if(void 0===b&&(b={}),!angular.isObject(a))throw TypeError(a+" option must be an object.");var c={};return angular.extend(c,b,a),c},b.getArray=function(a,b){return void 0===b&&(b=[]),b.concat(a)},b}();a.Options=b}(b=a.Options||(a.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function a(){this.strictMode=!0}return a.prototype.init=function(a){var b=this;this._dispatch=d3.dispatch.apply(this,a);var c=(new Date).getTime();return d3.select(window).on("mouseup."+c,function(){d3.event.preventDefault(),b.trigger("window-mouseup")}),d3.select(window).on("mousemove."+c,function(){d3.event.preventDefault(),b.trigger("window-mousemove")}),this},a.prototype.update=function(a,b){this.data=a,this.options=b},a.prototype.on=function(b,c){if(this.strictMode&&-1===a.EVENTS.indexOf(b.split(".")[0]))throw new Error("Unknown event: "+b);return this._dispatch.on(b,c),this},a.prototype.trigger=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return this._dispatch[a].apply(this,b),this},a.prototype.triggerDataAndOptions=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return b.push(this.data),b.push(this.options),this._dispatch[a].apply(this,b),this},a.prototype.datumEnter=function(a,b){var c=this;return function(d){return d.on("mouseenter",function(d,e){c.trigger("enter",d,e,a,b)})}},a.prototype.datumOver=function(a,b){var c=this;return function(d){return d.on("mouseover",function(d,e){c.trigger("over",d,e,a,b)})}},a.prototype.datumMove=function(a,b){var c=this;return function(d){return d.on("mousemove",function(d,e){c.trigger("over",d,e,a,b)})}},a.prototype.datumLeave=function(a,b){var c=this;return function(d){return d.on("mouseleave",function(d,e){c.trigger("leave",d,e,a,b)})}},a.prototype.listenForDblClick=function(a,b,c){var d,e,f=this,g=5,h=null,i=function(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2))};return a.on("mousedown.dbl."+c,function(){d=d3.mouse(document.body),e=(new Date).getTime()}),a.on("mouseup.dbl."+c,function(){!d||i(d,d3.mouse(document.body))>g||(h&&f.options.doubleClickEnabled?(window.clearTimeout(h),h=null,b(d3.event)):h=window.setTimeout(function(a){return function(){h=null}}(d3.event),300))}),a},a.EVENTS=["create","update","data-update","resize","destroy","enter","over","move","leave","click","dblclick","legend-click","legend-over","legend-out","container-over","container-move","container-out","focus","toggle","outer-world-hover","outer-world-domain-change","pan","pan-end","zoom","zoom-end","zoom-pan-reset","window-mouseup","window-mousemove"],a}();a.EventManager=b}(b=a.Utils||(a.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function a(){this._factoryStack=[]}return a.prototype.index=function(a){return this._factoryStack.map(function(a){return a.key}).indexOf(a)},a.prototype.getBoundFunction=function(a,b){var c=this.get(a);return c?c[b].bind(c):null},a.prototype.get=function(a){var b=this.index(a);return b>-1?this._factoryStack[b].instance:null},a.prototype.all=function(){return this._factoryStack},a.prototype.turnFactoriesOff=function(a){var b=this,c=[];return a.forEach(function(a){var d=b.get(a);d.isOn()&&(d.off(),c.push(a))}),function(){return b.turnFactoriesOn(c)}},a.prototype.turnFactoriesOn=function(a){var b=this,c=[];return a.forEach(function(a){var d=b.get(a);d.isOff()&&(d.on(),c.push(a))}),function(){return b.turnFactoriesOff(c)}},a.prototype.registerMany=function(a){var b=this;return a.forEach(function(a){b.register.apply(b,a)}),this},a.prototype.register=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];var e=b.bind.apply(b,[null].concat(c)),f=new e;return this._factoryStack.push({key:a,instance:f}),f},a.prototype.unregister=function(a){var b=this.index(a);return b>-1&&delete this._factoryStack[b],this},a}();a.FactoryManager=b}(b=a.Utils||(a.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function a(a,b){this.fromJS(a,b)}return a.prototype.fromJS=function(a,b){this.id=b,this.values=a},a}();a.Dataset=b}(b=a.Utils||(a.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function b(a){a&&this.fromJS(a)}return b.prototype.fromJS=function(b){var c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=new a.Dataset(b[d],d));this.sets=c},b.prototype.getDatasets=function(a,b){var c=this;return a.map(function(a){return c.getDatasetValues(a,b)})},b.prototype.getDatasetValues=function(a,b){if(!this.sets||!this.sets[a.dataset].values)return[];var c,d=b.getAbsKey();return c=a.key.y0?function(b){return{x:b[d],y1:b[a.key.y1],y0:b[a.key.y0]}}:function(b){return{x:b[d],y1:b[a.key.y1],y0:0}},this.sets[a.dataset].values.map(c)},b.getMinDistance=function(a,b,c,d){return void 0===c&&(c="x"),d3.min(a.map(function(a){return a.map(function(a){return b.scale(a[c])}).filter(function(a){return d?a>=d[0]&&a<=d[1]:!0}).reduce(function(a,b,c,d){var e=c>0?b-d[c-1]:Number.MAX_VALUE;return a>e?e:a},Number.MAX_VALUE)}))},b}();a.Data=b}(b=a.Utils||(a.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function a(){}return a.debounce=function(a,b){var c=this,d=null;return function(){for(var e=[],f=0;f<arguments.length;f++)e[f-0]=arguments[f];d&&window.clearTimeout(d),d=window.setTimeout(function(){return a.apply(c,e)},b)}},a}();a.FunctionUtils=b;var c=function(){function a(){}return a.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},a}();a.UUID=c}(b=a.Utils||(a.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(){function a(){this.enabled=!0}return a.prototype.init=function(a,b,c){this.key=a,this.eventMgr=b,this.factoryMgr=c,this.eventMgr.on("create."+this.key,this.create.bind(this)),this.eventMgr.on("update."+this.key,this.update.bind(this)),this.eventMgr.on("destroy."+this.key,this.destroy.bind(this))},a.prototype.on=function(){this.enabled=!0},a.prototype.off=function(){this.enabled=!1},a.prototype.isOn=function(){return this.enabled===!0},a.prototype.isOff=function(){return this.enabled===!1},a.prototype.create=function(a){},a.prototype.update=function(a,b){},a.prototype.destroy=function(){},a}();a.BaseFactory=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){"use strict";var c=function(b){function c(c){b.call(this),this.element=c,this.dim=new a.Options.Dimensions}return __extends(c,b),c.prototype.create=function(a){var b=this;this.dim.updateMargins(a),this.listenToElement(this.element,a),this.createRoot(),this.createContainer(),this.dim.fromParentElement(this.element.parentElement),this.eventMgr.on("resize",function(){b.dim.fromParentElement(b.element.parentElement),b.update()}),this.eventMgr.listenForDblClick(this.svg,function(){b.eventMgr.trigger("zoom-pan-reset",!0)},this.key),this.eventMgr.on("zoom-pan-reset."+this.key,function(a){b.eventMgr.triggerDataAndOptions("update")})},c.prototype.listenToElement=function(a,b){var c=this.eventMgr;a.addEventListener("mouseover",function(a){c.triggerDataAndOptions.apply(c,["container-over",a])}),a.addEventListener("mousemove",function(a){c.triggerDataAndOptions.apply(c,["container-move",a])}),a.addEventListener("mouseout",function(a){c.triggerDataAndOptions.apply(c,["container-out",a])})},c.prototype.getCoordinatesFromEvent=function(a){var b=this.getDimensions(),c=a.currentTarget.getBoundingClientRect(),d=c.left,e=c.top,f=this.factoryMgr.get("x-axis"),g=f.invert(a.clientX-d-b.margin.left),h=this.factoryMgr.get("y-axis"),i=h.invert(a.clientY-e-b.margin.top);return{y:i,x:g}},c.prototype.update=function(){this.updateRoot(),this.updateContainer()},c.prototype.destroy=function(){this.destroyRoot()},c.prototype.createRoot=function(){this.svg=d3.select(this.element).append("svg").attr("class","chart"),this.defs=this.svg.append("defs")},c.prototype.updateRoot=function(){this.svg.attr("width",this.dim.width).attr("height",this.dim.height)},c.prototype.destroyRoot=function(){this.svg.remove()},c.prototype.createContainer=function(){this.vis=this.svg.append("g").attr("class","container"),this.axes=this.vis.append("g").attr("class","axes"),this.clippingPathId="clipping-path-"+a.Utils.UUID.generate(),this.defs.append("svg:clipPath").attr("id",this.clippingPathId).append("svg:rect").attr("id","clipping-rect"),this.data=this.vis.append("g").attr({"class":"data","clip-path":"url(#"+this.clippingPathId+")"}),this.overlay=this.vis.append("g").attr("class","overlay")},c.prototype.updateContainer=function(){this.vis.attr({width:this.dim.innerWidth,height:Math.max(this.dim.innerHeight,0),transform:"translate("+this.dim.margin.left+", "+this.dim.margin.top+")"}),d3.select(this.element).select("#clipping-rect").attr({width:Math.max(this.dim.innerWidth,0),height:Math.max(this.dim.innerHeight,0)})},c.prototype.getDimensions=function(){return this.dim},c}(b.BaseFactory);b.Container=c}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){"use strict";var c=function(b){function c(a){b.call(this),this.element=a}return __extends(c,b),c.prototype.off=function(){b.prototype.off.call(this),this.hide()},c.prototype.create=function(a){this.options=a,this.createTooltip(),this.eventMgr.on("container-move.tooltip",this.show.bind(this)),this.eventMgr.on("container-out.tooltip",this.hide.bind(this)),this.eventMgr.on("outer-world-hover.tooltip",this.showFromCoordinates.bind(this)),this.hide()},c.prototype.update=function(a,b){this.options=b},c.prototype.createTooltip=function(){var a=this.svg=d3.select(this.element).append("div").attr("class","chart-tooltip");a.append("div").attr("class","abscissas"),this.line=this.factoryMgr.get("container").overlay.append("line").attr("class","tooltip-line"),this.dots=this.factoryMgr.get("container").overlay.append("g").attr("class","tooltip-dots")},c.prototype.destroy=function(){this.svg.remove()},c.prototype.getClosestRows=function(a,b,c){for(var d=c.series.filter(function(a){return a.visible}),e=d.map(function(a){return b.getDatasetValues(a,c).filter(a.defined)}),f=[],g=-1,h=Number.POSITIVE_INFINITY,i=[],j=0;j<e.length;j++)for(var k=0;k<e[j].length;k++){if("date"===c.axes.x.type)var l=Math.abs(e[j][k].x.getTime()-a);else var l=Math.abs(e[j][k].x-a);var m=d[j];l===h&&-1===i.indexOf(m)?(f.push({series:m,row:e[j][k]}),i.push(m)):h>l&&(h=l,f=[{series:d[j],row:e[j][k]}],i=[m],g=k)}return{rows:f,index:g}},c.prototype.showFromCoordinates=function(a,b,c){if(!this.isOff()){var d=a.x,e=a.y;if(void 0===d||void 0===e)return void this.hide(void 0,b,c);d instanceof Date&&(d=d.getTime());var f=this.getClosestRows(d,b,c),g=f.rows,h=f.index;if(0===g.length)return void this.hide(void 0,b,c);this.updateTooltipDots(g),this.dots.style("opacity","1"),this.updateLinePosition(g),this.line.style("opacity","1");var i=this.getTooltipContent(g,h,c);c.tooltipHook&&(i=c.tooltipHook(g)),i&&(this.updateTooltipContent(i,h,c),this.updateTooltipPosition(g),this.svg.style("display",null))}},c.prototype.show=function(a,b,c){if(!this.isOff()){var d=this.factoryMgr.get("container"),e=d.getCoordinatesFromEvent(a);this.showFromCoordinates(e,b,c)}},c.prototype.hide=function(a,b,c){this.svg.style("display","none"),this.line.style("opacity","0"),this.dots.style("opacity","0"),c&&c.tooltipHook&&c.tooltipHook(void 0)},c.prototype.getTooltipContent=function(b,c,d){var e=d.getByAxisSide(a.Options.AxisOptions.SIDE.X).tickFormat,f=function(a){return d.getByAxisSide(a).tickFormat},g=function(a){var b=f(a.series.axis),d=b?function(a){return b(a,c)}:function(a){return a},e=d(a.row.y1);return a.series.hasTwoKeys()?"["+d(a.row.y0)+", "+e+"]":e};return{abscissas:e?e(b[0].row.x,c):b[0].row.x,rows:b.map(function(a){return{label:a.series.label,value:g(a),color:a.series.color,id:a.series.id}})}},c.prototype.updateTooltipContent=function(a,b,c){this.svg.select(".abscissas").text(a.abscissas);var d=function(a){return a.attr({"class":"tooltip-item"}),a.append("div").attr({"class":"color-dot"}).style({"background-color":function(a){return a.color}}),a.append("div").attr({"class":"series-label"}),a.append("div").attr({"class":"y-value"}),a},e=function(a){return a.select(".series-label").text(function(a){return a.label}),a.select(".y-value").text(function(a){return a.value}),a},f=this.svg.selectAll(".tooltip-item").data(a.rows,function(a,b){return a.id?a.id:b});f.enter().append("div").call(d).call(e),f.call(e),f.exit().remove()},c.prototype.updateTooltipDots=function(a){var b=this,c=this.factoryMgr.get("x-axis").scale,d=function(a){return b.factoryMgr.get(a+"-axis").scale},e=3,f=function(a,b,c){return"M "+b+" "+c+" m -"+a+", 0 a "+a+","+a+" 0 1,0 "+2*a+",0 a "+a+","+a+" 0 1,0 -"+2*a+",0 "},g=function(a){a.attr("class","tooltip-dots-group"),a.append("path").attr({"class":"tooltip-dot y1"}).on("click",function(a,c){b.eventMgr.trigger("click",a.row,c,a.series,b.options)}),a.append("path").attr({"class":"tooltip-dot y0"}).style({display:function(a){return a.series.hasTwoKeys()?null:"none"}}).on("click",function(a,c){b.eventMgr.trigger("click",a.row,c,a.series,b.options)})},h=function(a){a.select(".tooltip-dot.y1").attr({d:function(a){return f(e,c(a.row.x),d(a.series.axis)(a.row.y1))},stroke:function(a){return a.series.color}}),a.select(".tooltip-dot.y0").attr({d:function(a){return a.series.hasTwoKeys()?f(e,c(a.row.x),d(a.series.axis)(a.row.y0)):""},stroke:function(a){return a.series.color}})},i=this.dots.selectAll(".tooltip-dots-group").data(a);i.enter().append("g").call(g).call(h),i.call(h),i.exit().remove()},c.prototype.updateTooltipPosition=function(a){var b=a.slice(-1)[0],c=this.factoryMgr.get("x-axis"),d=(this.factoryMgr.get("y-axis").scale,this.factoryMgr.get("container").getDimensions().margin),e=this.element.offsetLeft,f=this.element.offsetTop,g=0,h="";c.isInLastHalf(b.row.x)?(h="translate(-100%, 0)",g=-10):g=10,this.svg.style({left:e+d.left+c.scale(b.row.x)+g+"px",top:f+d.top+"px",transform:h})},c.prototype.updateLinePosition=function(a){var b=this.factoryMgr.get("container"),c=b.getDimensions(),d=a.slice(-1)[0],e=this.factoryMgr.get("x-axis"),f=e.scale(d.row.x);this.line.attr({x1:f,x2:f,y1:-c.margin.top,y2:c.innerHeight})},c}(b.BaseFactory);b.Tooltip=c}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b){a.call(this),this.element=b}return __extends(b,a),b.prototype.create=function(){this.createLegend()},b.prototype.createLegend=function(){this.div=d3.select(this.element).append("div").attr("class","chart-legend").style("position","absolute")},b.prototype.legendClick=function(){var a=this;return function(b){return b.on("click",function(b){a.eventMgr.trigger("legend-click",b)})}},b.prototype.update=function(a,b){var c=this,d=this.factoryMgr.get("container"),e=(d.getDimensions(),function(a){var b=a.append("div").attr({"class":"item"}).call(c.legendClick());b.append("div").attr({"class":"icon"}),b.append("div").attr({"class":"legend-label"})}),f=function(a){a.attr("class",function(a){return"item "+a.type.join(" ")}).classed("legend-hidden",function(a){return!a.visible}),a.select(".icon").style("background-color",function(a){return a.color}),a.select(".legend-label").text(function(a){return a.label})},g=this.div.selectAll(".item").data(b.series);g.enter().call(e),g.call(f),g.exit().remove()},b.prototype.destroy=function(){this.div.remove()},b}(a.BaseFactory);a.Legend=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){"use strict";var c=function(b){function c(c){var d=this;if(b.call(this),this.side=c,!a.Options.AxisOptions.isValidSide(c))throw new TypeError("Wrong axis side : "+c);this.scale=function(a){return d._scale.call(d,a)}}return __extends(c,b),c.prototype.range=function(){return this._scale.range()},c.prototype.getDomain=function(){return this._scale.domain()},c.prototype.setDomain=function(a){return this._scale.domain.call(this,a)},c.prototype.create=function(){var a=this.factoryMgr.get("container").axes;this.createAxis(a),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.updateFromOuterWorld.bind(this)),this.eventMgr.on("resize."+this.key,this.onResize.bind(this))},c.prototype.updateFromOuterWorld=function(a){this.updateScaleDomain(a[this.side[0]]),this.softUpdate()},c.prototype.softUpdate=function(){this.factoryMgr.get("transitions").isOn()?this.svg.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.d3axis):this.svg.call(this.d3axis)},c.prototype.onResize=function(){var a=this.factoryMgr.get("container"),b=a.getDimensions();this.updateScaleRange(b,this.options),this.updateAxisContainer(b),this.softUpdate()},c.prototype.update=function(a,b){var c=this.factoryMgr.get("container"),d=c.getDimensions(),e=this.getExtent(a,b);this.options=b.getByAxisSide(this.side),this._scale=this.getScale(),this.updateScaleRange(d,this.options),this.updateScaleDomain(e),this.d3axis=this.getAxis(this._scale,this.options),this.updateAxisOrientation(this.d3axis),this.updateAxisContainer(d),this.shiftAxisTicks(this.options)},c.prototype.shiftAxisTicks=function(a){var b=a.ticksShift,c=b.x,d=b.y;this.svg.selectAll("text").attr("transform","translate("+c+", "+d+")")},c.prototype.destroy=function(){this.destroyAxis()},c.prototype.updateScaleRange=function(a,b){this.isAbscissas()?this._scale.range([b.padding.min,a.innerWidth-b.padding.max]):this._scale.range([a.innerHeight-b.padding.min,b.padding.max])},c.prototype.updateScaleDomain=function(a){this._scale.domain(a)},c.prototype.getScaleDomain=function(){return this._scale?this._scale.domain():[0,1]},c.prototype.getExtentForDatasets=function(a,b,c,d){void 0===d&&(d=!1);var e=d?0:Number.POSITIVE_INFINITY,f=d?0:Number.NEGATIVE_INFINITY;for(var g in a.sets)b(g)&&a.sets[g].values.forEach(function(a){var b=c(a,g);b[0]<e&&(e=b[0]),b[1]>f&&(f=b[1])});return e===f&&(f=e+1),[e===Number.POSITIVE_INFINITY?0:e,f===Number.NEGATIVE_INFINITY?1:f]},c.prototype.getExtent=function(a,b){var c=b.getByAxisSide(this.side),d=void 0;if(this.isAbscissas()){var e=b.getVisibleDatasets(),f=b.getAbsKey();d=this.getExtentForDatasets(a,function(a){return e.indexOf(a)>-1},function(a){return[a[f],a[f]]})}else{var g=b.getSeriesAndDatasetBySide(this.side),h=g.datasetsForSide,i=g.seriesForDataset;d=this.getExtentForDatasets(a,function(a){return h.indexOf(a)>-1},function(a,b){var c=i[b].map(function(b){return a[b.key.y1]}),d=i[b].map(function(b){return a[b.key.y0]||a[b.key.y1]});return[d3.min(d),d3.max(c)]},b.getByAxisSide(this.side).includeZero)}return void 0!==c.min&&(d[0]=c.min),void 0!==c.max&&(d[1]=c.max),d},c.prototype.isAbscissas=function(){return-1!==[a.Options.AxisOptions.SIDE.X,a.Options.AxisOptions.SIDE.X2].indexOf(this.side)},c.prototype.isInLastHalf=function(a){var b=function(a){return a};a instanceof Date&&(b=function(a){return a.getTime()});var c=this._scale.domain(),d=c[0],e=c[1];return b(a)>b(d)+(b(e)-b(d))/2},c.prototype.createAxis=function(a){this.svg=a.append("g").attr("class","axis "+this.side+"-axis")},c.prototype.updateAxisOrientation=function(b){this.isAbscissas()?this.side===a.Options.AxisOptions.SIDE.X?b.orient("bottom"):b.orient("top"):this.side===a.Options.AxisOptions.SIDE.Y?b.orient("left"):b.orient("right")},c.prototype.updateAxisContainer=function(b){this.isAbscissas()?this.side===a.Options.AxisOptions.SIDE.X?this.svg.attr("transform","translate(0, "+b.innerHeight+")"):this.svg.attr("transform","translate(0, 0)"):this.side===a.Options.AxisOptions.SIDE.Y?this.svg.attr("transform","translate(0, 0)"):this.svg.attr("transform","translate("+b.innerWidth+", 0)"),this.softUpdate()},c.prototype.destroyAxis=function(){this.svg.remove()},c.prototype.invert=function(a){return this._scale.invert(a)},c.prototype.isTimeAxis=function(){return this.options.type===a.Options.AxisOptions.TYPE.DATE},c.prototype.getScale=function(){return this.options&&this.options.type===a.Options.AxisOptions.TYPE.DATE?d3.time.scale():this.options&&this.options.type===a.Options.AxisOptions.TYPE.LOG?d3.scale.log():d3.scale.linear()},c.prototype.getAxis=function(b,c){var d;return d=c.hasDynamicTicks()?a.svg.twoSpeedAxis().scale(b):d3.svg.axis().scale(b),c.configure(d),d},c.prototype.cloneAxis=function(){var b;return b=this.options&&this.options.hasDynamicTicks()?a.svg.twoSpeedAxis().ticks(this.d3axis.ticks()):d3.svg.axis().ticks(this.d3axis.ticks()[0]),b.scale(this.d3axis.scale()).orient(this.d3axis.orient()).tickValues(this.d3axis.tickValues()).tickSize(this.d3axis.tickSize())},c}(b.BaseFactory);b.Axis=c}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(){this.svg=this.factoryMgr.get("container").axes.insert("g",":first-child").attr("class","grid"),this.svg.append("g").classed("x-grid",!0),this.svg.append("g").classed("y-grid",!0),this.eventMgr.on("resize."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this))},b.prototype.softUpdate=function(){var a=this.factoryMgr.get("container"),b=a.getDimensions();
if(this.xAxis){var c=this.svg.select(".x-grid");this.factoryMgr.get("transitions").isOn()&&(c=c.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),c.attr("transform","translate(0, "+b.innerHeight+")").call(this.xAxis.tickSize(-b.innerHeight,0))}if(this.yAxis){var c=this.svg.select(".y-grid");this.factoryMgr.get("transitions").isOn()&&(c=c.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),c.call(this.yAxis.tickSize(-b.innerWidth,0))}},b.prototype.update=function(a,b){var c=this.factoryMgr.get("container"),d=c.getDimensions();b.grid.x&&(this.xAxis=this.factoryMgr.get("x-axis").cloneAxis().tickSize(-d.innerHeight,0),this.svg.select(".x-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("transform","translate(0, "+d.innerHeight+")").call(this.xAxis)),b.grid.y&&(this.yAxis=this.factoryMgr.get("y-axis").cloneAxis(),this.svg.select(".y-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.yAxis.tickSize(-d.innerWidth,0)))},b.prototype.destroy=function(){this.svg.remove()},b}(a.BaseFactory);a.Grid=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments),this.isActive=!1}return __extends(b,a),b.prototype.create=function(){this.rect=this.factoryMgr.get("container").svg.append("rect").attr("class","chart-brush")},b.prototype.constrainOutgoingDomains=function(a){this.zoomOnX||delete a.x,this.zoomOnY||delete a.y},b.prototype.update=function(a,b){var c=this.factoryMgr.get("container").getDimensions(),d=c.margin,e=d.left,f=d.top;this.zoomOnX=b.zoom.x,this.zoomOnY=b.zoom.y,(this.zoomOnX||this.zoomOnY)&&(this.xStartFn=this.zoomOnX?function(a){return a}:function(a){return e},this.xEndFn=this.zoomOnX?function(a){return a}:function(a){return c.innerWidth+e},this.yStartFn=this.zoomOnY?function(a){return a}:function(a){return f},this.yEndFn=this.zoomOnY?function(a){return a}:function(a){return c.innerHeight+f},this.registerEvents(this.factoryMgr.get("container")))},b.prototype.show=function(a){var b=a.xStart,c=a.xEnd,d=a.yStart,e=a.yEnd;f=b>c?[c,b]:[b,c],b=f[0],c=f[1],g=d>e?[e,d]:[d,e],d=g[0],e=g[1],this.rect.attr({x:b,width:c-b,y:d,height:e-d}).style("opacity","1");var f,g},b.prototype.hide=function(){this.rect.style("opacity","0")},b.prototype.updateAxes=function(a){var b=a.xStart,c=a.xEnd,d=a.yStart,e=a.yEnd;n=b>c?[c,b]:[b,c],b=n[0],c=n[1],o=d>e?[e,d]:[d,e],d=o[0],e=o[1];var f=this.factoryMgr.get("container").getDimensions(),g=f.margin,h=g.left,i=g.top,j=this.factoryMgr.get("x-axis"),k=this.factoryMgr.get("x2-axis");j.setDomain([j.invert(b-h),j.invert(c-h)]),k.setDomain(j.getDomain());var l=this.factoryMgr.get("y-axis"),m=this.factoryMgr.get("y2-axis");l.setDomain([l.invert(e-i),l.invert(d-i)]),m.setDomain([m.invert(e-i),m.invert(d-i)]);var n,o},b.prototype.registerEvents=function(a){var b,c,d,e,f,g=this,h=function(a){return a+"."+g.key},i=function(){g.isActive=!1,g.hide(),void 0!==c&&void 0!==e&&(g.updateAxes({xStart:b,xEnd:c,yStart:d,yEnd:e}),g.eventMgr.trigger("zoom-end"),b=c=d=e=void 0,f()),g.eventMgr.on(h("window-mouseup"),null)};a.svg.on(h("mousedown"),function(){var a=d3.event;a.altKey&&(f=g.factoryMgr.turnFactoriesOff(["tooltip"]),g.isActive=!0,g.eventMgr.on(h("window-mouseup"),i),c=d3.mouse(a.currentTarget),b=c[0],d=c[1],b=g.xStartFn(b),d=g.yStartFn(d));var c}).on(h("mousemove"),function(){g.isActive&&(a=d3.mouse(d3.event.currentTarget),c=a[0],e=a[1],c=g.xEndFn(c),e=g.yEndFn(e),g.show({xStart:b,xEnd:c,yStart:d,yEnd:e}),g.eventMgr.trigger("zoom"));var a})},b}(a.BaseFactory);a.Zoom=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments),this.isActive=!1,this.hasMoved=!1}return __extends(b,a),b.prototype.constrainOutgoingDomains=function(a){this.panOnX||delete a.x,this.panOnY||delete a.y},b.prototype.move=function(a,b){if(0!==a){var c=this.factoryMgr.get("x-axis"),d=this.factoryMgr.get("x2-axis");c.setDomain(c.range().map(function(b){return b+a}).map(c.invert,c)),d.setDomain(c.getDomain())}if(0!==b){var e=this.factoryMgr.get("y-axis"),f=this.factoryMgr.get("y2-axis");e.setDomain(e.range().map(function(a){return a+b}).map(e.invert,e)),f.setDomain(f.range().map(function(a){return a+b}).map(f.invert,f))}},b.prototype.update=function(a,b){var c=this;this.panOnX=b.pan.x,this.panOnY=b.pan.y;var d,e,f,g=this.factoryMgr.get("container"),h=function(a){return a+"."+c.key},i=function(){c.hasMoved&&c.eventMgr.trigger("pan-end"),f&&f(),c.isActive=c.hasMoved=!1,f=void 0,c.eventMgr.on(h("window-mouseup"),null),c.eventMgr.on(h("window-mousemove"),null)},j=function(){if(c.isActive){var a=d3.mouse(g.svg.node()),b=a[0],h=a[1],i=c.panOnX?d-b:0,j=c.panOnY?e-h:0;0===i&&0===j||(f||(f=c.factoryMgr.turnFactoriesOff(["tooltip","transitions"])),c.hasMoved=!0,c.move(i,j),c.eventMgr.trigger("pan")),k=[b,h],d=k[0],e=k[1]}var k};g.svg.on(h("mousedown"),function(){var a=d3.event;a.altKey||(c.isActive=!0,b=d3.mouse(a.currentTarget),d=b[0],e=b[1],c.eventMgr.on(h("window-mouseup"),i),c.eventMgr.on(h("window-mousemove"),j));var b})},b}(a.BaseFactory);a.Pan=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(){a.apply(this,arguments),this.duration=b.defaultDuration,this.ease="cubic"}return __extends(b,a),b.prototype.off=function(){a.prototype.off.call(this),this.duration=0},b.prototype.on=function(){a.prototype.on.call(this),this.duration=b.defaultDuration},b.prototype.enter=function(a){var b=this.duration,c=this.ease,d=a[0].length,e=function(a,c){return d?c/d*b:0};a.duration(b).delay(e).ease(c)},b.prototype.edit=function(a){var b=this.duration,c=this.ease,d=0;a.duration(b).delay(d).ease(c)},b.prototype.exit=function(a){var b=this.duration,c=this.ease,d=0;a.duration(b).delay(d).ease(c)},b.defaultDuration=250,b}(a.BaseFactory);a.Transition=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){var c;!function(b){"use strict";var c=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.create=function(){this.createContainer(this.factoryMgr.get("container").data),this.eventMgr.on("data-update."+this.type,this.update.bind(this)),this.eventMgr.on("pan."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("resize."+this.type,this.softUpdate.bind(this))},b.prototype.update=function(a,b){this.data=a,this.options=b,this.softUpdate()},b.prototype.getAxes=function(a){return{xAxis:this.factoryMgr.get("x-axis"),yAxis:this.factoryMgr.get(a.axis+"-axis")}},b.prototype.softUpdate=function(){var a=this.options.getSeriesByType(this.type).filter(function(a){return a.visible});this.updateSeriesContainer(a)},b.prototype.destroy=function(){this.svg.remove()},b.prototype.createContainer=function(a){this.svg=a.append("g").attr("class",this.type+b.containerClassSuffix)},b.prototype.updateSeriesContainer=function(a){var c=this,d=this.svg.selectAll("."+this.type+b.seriesClassSuffix).data(a,function(a){return a.id});d.enter().append("g").attr({"class":function(a){return c.type+b.seriesClassSuffix+" "+a.id}}),this.styleSeries(d),this.updateSeries(d,a),d.exit().remove()},b.prototype.updateSeries=function(a,b){var c=this;a.each(function(a,d){var e=d3.select(this);c.updateData(e,a,d,b.length)})},b.prototype.updateData=function(a,b,c,d){},b.prototype.styleSeries=function(a){},b.containerClassSuffix="-data",b.seriesClassSuffix="-series",b}(a.Factory.BaseFactory);b.SeriesFactory=c}(c=b.Series||(b.Series={}))}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=function(b){function c(){b.apply(this,arguments),this.type=a.Options.SeriesOptions.TYPE.DOT}return __extends(c,b),c.prototype.updateData=function(a,b,c,d){var e=this.getAxes(b),f=e.xAxis,g=e.yAxis,h=this.data.getDatasetValues(b,this.options).filter(b.defined),i=2,j=a.selectAll("."+this.type).data(h,function(a){return""+a.x}),k=function(a){a.attr({r:function(a){return i},cx:function(a){return f.scale(a.x)},cy:function(a){return g.range()[0]}})},l=function(a){a.attr({cx:function(a){return f.scale(a.x)},cy:function(a){return g.scale(a.y1)}}).style("opacity",b.visible?1:0)};this.factoryMgr.get("transitions").isOn()?(j.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(b,this.options)).call(this.eventMgr.datumOver(b,this.options)).call(this.eventMgr.datumMove(b,this.options)).call(this.eventMgr.datumLeave(b,this.options)).call(k).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(l),j.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(l),j.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(k).each("end",function(){d3.select(this).remove()})):(j.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(b,this.options)).call(this.eventMgr.datumOver(b,this.options)).call(this.eventMgr.datumMove(b,this.options)).call(this.eventMgr.datumLeave(b,this.options)).call(l),j.call(l),j.exit().remove())},c.prototype.styleSeries=function(a){a.style({stroke:function(a){return a.color}})},c}(b.Series.SeriesFactory);c.Dot=d}(c=b.Series||(b.Series={}))}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=function(b){function c(){b.apply(this,arguments),this.type=a.Options.SeriesOptions.TYPE.LINE}return __extends(c,b),c.prototype.updateData=function(a,b,c,d){a.classed("dashed",b.isDashed());var e=this.getAxes(b),f=e.xAxis,g=e.yAxis,h=this.data.getDatasetValues(b,this.options),i=d3.svg.line().defined(b.defined).x(function(a){return f.scale(a.x)}).y(g.range()[0]).interpolate(b.interpolation.mode).tension(b.interpolation.tension),j=d3.svg.line().defined(b.defined).x(function(a){return f.scale(a.x)}).y(function(a){return g.scale(a.y1)}).interpolate(b.interpolation.mode).tension(b.interpolation.tension),k=a.selectAll("."+this.type).data([h]);this.factoryMgr.get("transitions").isOn()?(k.enter().append("path").attr("class",this.type).attr("d",function(a){return i(a)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(a){return j(a)}),k.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(a){return j(a)}).style("opacity",b.visible?1:0),k.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(a){return i(a)}).each("end",function(){d3.select(this).remove()})):(k.enter().append("path").attr("class",this.type).attr("d",function(a){return j(a)}),k.attr("d",function(a){return j(a)}).style("opacity",b.visible?1:0),k.exit().remove())},c.prototype.styleSeries=function(a){a.style({fill:"none",stroke:function(a){return a.color},"stroke-dasharray":function(a){return a.isDashed()?"10,3":void 0}})},c}(b.Series.SeriesFactory);c.Line=d}(c=b.Series||(b.Series={}))}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=function(b){function c(){b.apply(this,arguments),this.type=a.Options.SeriesOptions.TYPE.AREA}return __extends(c,b),c.prototype.updateData=function(a,b,c,d){var e=this.getAxes(b),f=e.xAxis,g=e.yAxis,h=this.data.getDatasetValues(b,this.options),i=d3.svg.area().defined(b.defined).x(function(a){return f.scale(a.x)}).y0(g.range()[0]).y1(g.range()[0]).interpolate(b.interpolation.mode).tension(b.interpolation.tension),j=d3.svg.area().defined(b.defined).x(function(a){return f.scale(a.x)}).y0(function(a){return isNaN(g.scale(a.y0))?g.range()[0]:g.scale(a.y0)}).y1(function(a){return g.scale(a.y1)}).interpolate(b.interpolation.mode).tension(b.interpolation.tension),k=a.selectAll("."+this.type).data([h]);this.factoryMgr.get("transitions").isOn()?(k.enter().append("path").attr("class",this.type).attr("d",function(a){return i(a)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(a){return j(a)}),k.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(a){return j(a)}).style("opacity",b.visible?1:0),k.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(a){return i(a)}).each("end",function(){d3.select(this).remove()})):(k.enter().append("path").attr("class",this.type).attr("d",function(a){return j(a)}),k.attr("d",function(a){return j(a)}).style("opacity",b.visible?1:0),k.exit().remove())},c.prototype.styleSeries=function(a){a.style({fill:function(a){return a.color},stroke:function(a){return a.color}})},c}(b.Series.SeriesFactory);c.Area=d}(c=b.Series||(b.Series={}))}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(b){var c;!function(c){"use strict";var d=function(b){function c(){b.apply(this,arguments),this.type=a.Options.SeriesOptions.TYPE.COLUMN,this.gapFactor=.2,this.outerPadding=this.gapFactor/2*3,this.columnsWidth=0}return __extends(c,b),c.prototype.softUpdate=function(){var a=this.options.getSeriesByType(this.type).filter(function(a){return a.visible});this.updateColumnsWidth(a,this.options),this.updateColumnScale(a,this.options),this.updateSeriesContainer(a)},c.prototype.update=function(a,b){this.data=a,this.options=b;var c=b.getSeriesByType(this.type).filter(function(a){return a.visible});this.updateColumnsWidth(c,b),this.updateColumnScale(c,b),this.updateSeriesContainer(c)},c.prototype.updateColumnsWidth=function(b,c){var d=this.factoryMgr.get("x-axis"),e=this.data.getDatasets(b,c),f=a.Utils.Data.getMinDistance(e,d,"x");this.columnsWidth=f<Number.MAX_VALUE?f/b.length:10},c.prototype.updateColumnScale=function(a,b){var c=this.columnsWidth*a.length/2;this.innerXScale=d3.scale.ordinal().domain(a.map(function(a){return a.id})).rangeBands([-c,c],0,.1)},c.prototype.getTooltipPosition=function(a){return this.innerXScale(a.id)+this.innerXScale.rangeBand()/2},c.prototype.updateData=function(a,b,c,d){var e=this,f=this.getAxes(b),g=f.xAxis,h=f.yAxis,i=this.data.getDatasetValues(b,this.options).filter(b.defined),j=function(a){return g.scale(a.x)+e.innerXScale(b.id)},k=function(a){a.attr({x:j,y:function(a){return h.scale(a.y0)},width:e.innerXScale.rangeBand(),height:0})},l=function(a){a.attr({x:j,y:function(a){return a.y1>0?h.scale(a.y1):h.scale(a.y0)},width:e.innerXScale.rangeBand(),height:function(a){return Math.abs(h.scale(a.y0)-h.scale(a.y1))}}).style("opacity",b.visible?1:0)},m=a.selectAll("."+this.type).data(i,function(a){return""+a.x});this.factoryMgr.get("transitions").isOn()?(m.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(b,this.options)).call(this.eventMgr.datumOver(b,this.options)).call(this.eventMgr.datumMove(b,this.options)).call(this.eventMgr.datumLeave(b,this.options)).call(k).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(l),m.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(l),m.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(k).each("end",function(){d3.select(this).remove()})):(m.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(b,this.options)).call(this.eventMgr.datumOver(b,this.options)).call(this.eventMgr.datumMove(b,this.options)).call(this.eventMgr.datumLeave(b,this.options)).call(l),m.call(l),m.exit().remove())},c.prototype.styleSeries=function(a){a.style({fill:function(a){return a.color},stroke:function(a){return a.color},"stroke-width":1})},c}(b.Series.SeriesFactory);c.Column=d}(c=b.Series||(b.Series={}))}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){var b;!function(a){"use strict";var b=function(a){function b(b,c,d){a.call(this),this.scope=b,this.attributes=c,this.$parse=d}return __extends(b,a),b.prototype.create=function(){this.unregisteringFunctions=[],this.sanitizeAttributes(),this.syncTooltips(),this.syncDomainsChange(),this.syncDatumEvents()},b.prototype.sanitizeAttributes=function(){var a=this.attributes,b=a.tooltipSyncKey,c=a.domainsSyncKey;if(b&&c&&b===c)throw new Error("Heterogeneous sync keys can't have the same value.")},b.prototype.syncDatumEvents=function(){var a=this,b=this.eventMgr;if(this.attributes.onClick){var c=this.$parse(this.attributes.onClick);b.on("click.directive",function(b,d,e,f){c(a.scope.$parent,{row:b,index:d,series:e,options:f})})}},b.prototype.syncTooltips=function(){var a=this,b=this.eventMgr;this.attributes.tooltipSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.tooltipSyncKey,function(a,c){b.triggerDataAndOptions("outer-world-hover",c)})),b.on("container-move.directive",function(b){a.scope.$emit(a.attributes.tooltipSyncKey,a.factoryMgr.get("container").getCoordinatesFromEvent(b))}),b.on("container-out.directive",function(){a.scope.$emit(a.attributes.tooltipSyncKey,{x:void 0,y:void 0})}))},b.prototype.syncDomainsChange=function(){var a=this,b=this.eventMgr,c=[],d=this.factoryMgr.get("x-axis"),e=this.factoryMgr.get("y-axis");if(this.attributes.onDomainsChange){var f=this.$parse(this.attributes.onDomainsChange);c.push(function(b,c){var d=c.isEndEvent;d&&f(a.scope.$parent,{$domains:b})})}this.attributes.domainsSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.domainsSyncKey,function(c,f,g){c.targetScope!==a.scope&&(f.x&&f.y||(f=angular.copy(f)),f.x||(f.x=d.getScaleDomain()),f.y||(f.y=e.getScaleDomain()),"zoom-end"===g?(b.trigger("outer-world-domain-change",f),a.factoryMgr.turnFactoriesOn(["tooltip"])):"zoom"===g?a.factoryMgr.turnFactoriesOff(["tooltip"]):"pan"===g||"pan-end"===g?(a.factoryMgr.turnFactoriesOff(["transitions","tooltip"]),b.trigger("outer-world-domain-change",f),"pan-end"===g&&a.factoryMgr.turnFactoriesOn(["transitions","tooltip"])):"zoom-pan-reset"===g&&b.trigger("zoom-pan-reset",!1))})),c.push(function(b,c){var d=c.type;a.scope.$emit(a.attributes.domainsSyncKey,b,d)}));var g=function(){return{x:d.getScaleDomain(),y:e.getScaleDomain()}},h=function(a,b){return c.forEach(function(c){return c(a,b)})};b.on("pan.directive",function(){var b=g();a.factoryMgr.get("pan").constrainOutgoingDomains(b),h(b,{type:"pan"})}),b.on("pan-end.directive",function(){var b=g();a.factoryMgr.get("pan").constrainOutgoingDomains(b),h(b,{type:"pan-end",isEndEvent:!0})}),b.on("zoom.directive",function(){var b=g();a.factoryMgr.get("zoom").constrainOutgoingDomains(b),h(b,{type:"zoom",isEndEvent:!1})}),b.on("zoom-end.directive",function(){var b=g();a.factoryMgr.get("zoom").constrainOutgoingDomains(b),h(b,{type:"zoom-end",isEndEvent:!0})}),b.on("zoom-pan-reset.directive",function(a){a&&h(g(),{type:"zoom-pan-reset",isEndEvent:!0})})},b.prototype.destroy=function(){for(var a;a=this.unregisteringFunctions.pop();)a()},b}(a.BaseFactory);a.SyncLayer=b}(b=a.Factory||(a.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(a){"use strict";var b=function(){function b(b,c,d,e){var f=this;this.$window=b,this.$parse=c,this.$timeout=d,this.$rootScope=e,this.scope={data:"=",options:"=",styles:"=",hoveredCoordinates:"="},this.restrict="E",this.replace=!0,this.template="<div></div>",this.link=function(b,c,d){var e,g,h=new a.Utils.EventManager,i=new a.Utils.FactoryManager;h.init(a.Utils.EventManager.EVENTS),i.registerMany([["container",a.Factory.Container,c[0]],["tooltip",a.Factory.Tooltip,c[0]],["legend",a.Factory.Legend,c[0]],["transitions",a.Factory.Transition],["x-axis",a.Factory.Axis,a.Options.AxisOptions.SIDE.X],["x2-axis",a.Factory.Axis,a.Options.AxisOptions.SIDE.X2],["y-axis",a.Factory.Axis,a.Options.AxisOptions.SIDE.Y],["y2-axis",a.Factory.Axis,a.Options.AxisOptions.SIDE.Y2],["grid",a.Factory.Grid],["pan",a.Factory.Pan],["zoom",a.Factory.Zoom],["sync-layer",a.Factory.SyncLayer,b,d,f.$parse],["series-area",a.Factory.Series.Area],["series-column",a.Factory.Series.Column],["series-line",a.Factory.Series.Line],["series-dot",a.Factory.Series.Dot]]),i.all().forEach(function(a){return a.instance.init(a.key,h,i)});var j=void 0===b.options,k=function(){g=new a.Options.Options(angular.copy(b.options)),e=new a.Utils.Data(b.data),j&&(j=!1,h.trigger("create",g)),h.update(e,g),h.trigger("update",e,g)};j||h.trigger("create",new a.Options.Options(angular.copy(b.options)));var l=function(a){a&&(e.fromJS(a),i.turnFactoriesOff(["transitions"]),h.trigger("data-update",e,g),i.turnFactoriesOn(["transitions"]),h.trigger("update",e,g))};b.$watch("options",k,!0),b.$watch("data",l,!0),h.on("legend-click.directive",function(a){var c=b.options.series.filter(function(b){return b.id===a.id})[0];c.visible=a.getToggledVisibility(),b.$apply()});var m=function(){if(!c||!c[0])return{};var a=c[0].parentElement.getBoundingClientRect();return{height:a.height,width:a.width,left:a.left,right:a.right,bottom:a.bottom,top:a.top}},n=a.Utils.FunctionUtils.debounce(function(){h.trigger("resize",c[0].parentElement)},50);b.$watch(m,n,!0);var o=a.Utils.FunctionUtils.debounce(function(){return b.$apply()},50);angular.element(f.$window).on("resize",o),b.$on("$destroy",function(){h.trigger("destroy"),angular.element(f.$window).off("resize",o)})}}return b}();a.LineChart=b}(n3Charts||(n3Charts={})),angular.module("n3-line-chart",[]).directive("linechart",["$window","$parse","$timeout","$rootScope",function(a,b,c,d){return new n3Charts.LineChart(a,b,c,d)}]),angular.module("altizonApp",["ui.router","ui.bootstrap","ngResource","n3-line-chart"]).config(function(a,b,c){c.defaults.xsrfCookieName="CSRF-TOKEN",c.defaults.xsrfHeaderName="X-CSRF-TOKEN",b.otherwise("/"),a.state("site",{"abstract":!0,views:{"navbar@":{templateUrl:"views/pages/navbar.html",controller:"NavBarCtrl"},"footer@":{templateUrl:"views/pages/footer.html"}}}),c.interceptors.push("TokenInterceptor")}).run(function(a,b,c,d,e){a.$on("$stateChangeStart",function(a,b,f,g){null!==b&&null!==b.access&&b.access.requiredAuthentication&&!e.isAuthenticated&&void 0===d.sessionStorage.token&&c.path("/")})}),angular.module("altizonApp").controller("DashboardCtrl",function(a,b,c){a.things=c.things,a.callApiForGettingData=function(c){var d={thing_key:c,from:"2016/03/29 07:05:00",to:"2016/03/29 17:10:00",time_zone:"Mumbai",time_format:"str",per:"10"};a.isProcessing=!0,b.queryThingData(d).success(function(b){function c(a){var b=[];console.log("in function"),console.log(a);for(var c=0;c<a.length;c++){var d=[],e={};e.time=new Date(a[c].timestamp);for(var f in a[c].data)a[c].data.hasOwnProperty(f)&&a[c].data[f]!==!0&&a[c].data[f]!==!1&&(e[f]=a[c].data[f],d.indexOf(f)<=-1&&d.push(f));b.push(e)}return console.log("object In function"),b.push(d),console.log(b),b}a.isProcessing=!1,console.log(b);for(var d in b)if(b.hasOwnProperty(d))if(console.log(b[d]),void 0!==b[d].total_event_count)if(0!==b[d].total_event_count){var e=c(b[d].event_data),f=(e.pop(),e);console.log("Final Graph Data"),console.log(f),a.message="I got some data.. Graph Plotting is required..",a.graphData={dataset0:f},a.option1={series:[{axis:"y",dataset:"dataset0",key:"batt_lev",label:"Battery Level",color:"#1f77b4",type:["line","dot","area"],id:"mySeries0"}],axes:{x:{key:"time",type:"date"}}}}else a.message="No data exists for this thing...";else a.message="Internal Server error Reported by Altizon"})}}),angular.module("altizonApp").controller("LoginCtrl",function(a,b,c,d,e){a.login={userName:"",password:""},a.showLoginFailed=!1,a.isProcessing=!1,a.loginUser=function(){return a.isProcessing=!0,a.login.userName&&""!==a.login.userName&&a.login.password&&""!==a.login.password?void b.login(a.login).success(function(a){console.log(a),e.isAuthenticated=!0,c.sessionStorage.token=a.token,d.go("dashboard")}).error(function(b,c){a.isProcessing=!1,a.showLoginFailed=!0,console.log(b),console.log(c)}):void(a.isProcessing=!1)}}),angular.module("altizonApp").controller("LogoutCtrl",function(a,b,c,d,e){a.logOutUser=function(){e.isAuthenticated?c.logout().success(function(a){e.isAuthenticated=!1,delete d.sessionStorage.token,b.go("login")}).error(function(a,b){console.log(a),console.log(b)}):b.go("login")},a.logOutUser()}),angular.module("altizonApp").controller("NavBarCtrl",function(a,b,c,d,e){a.logOutUser=function(){e.isAuthenticated?c.logout().success(function(a){e.isAuthenticated=!1,delete d.sessionStorage.token,b.go("login")}).error(function(a,b){console.log(a),console.log(b)}):b.go("login")}}),angular.module("altizonApp").config(function(a){a.state("dashboard",{parent:"site",url:"/dashboard",access:{requiredAuthentication:!0},views:{"content@":{templateUrl:"views/pages/dashboard.html",controller:"DashboardCtrl"}},resolve:{getThings:function(a){return a.getAllThings().then(function(a){return a.data})}}})}),angular.module("altizonApp").config(function(a){a.state("login",{url:"/",access:{requiredAuthentication:!1},views:{"content@":{templateUrl:"views/pages/login.html",controller:"LoginCtrl"}}})}),angular.module("altizonApp").config(function(a){a.state("logout",{parent:"site",url:"/logout",access:{requiredAuthentication:!0},views:{"content@":{templateUrl:"views/pages/logout.html",controller:"LogoutCtrl"}}})}),angular.module("altizonApp").factory("AuthenticationService",function(){var a={isAuthenticated:!1,isAdmin:!1};return a}),angular.module("altizonApp").factory("DashboardService",function(a,b){return{getAllThings:function(){var b={};return b.url="/user/thing/getAllThings",b.method="GET",a(b).success(function(a){return a.data})},getThingDetails:function(b){var c={};return c.url="/user/thing/getThingDetails/"+b,c.method="GET",a(c)},queryThingData:function(b){var c={};return c.url="/user/thing/queryThingData",c.method="POST",c.data=b,a(c)}}}),angular.module("altizonApp").factory("LoginService",function(a){return{login:function(b){var c={};return c.url="/user/loginToAltizon",c.data=b,c.method="POST",a(c)}}}),angular.module("altizonApp").factory("LogoutService",function(a){return{logout:function(){var b={};return b.url="/user/logoutFromAltizon",b.method="GET",a(b)}}}),angular.module("altizonApp").factory("TokenInterceptor",function(a,b,c,d){return{request:function(a){return a.headers=a.headers||{},b.sessionStorage.token&&(a.headers.authorization=b.sessionStorage.token),a},requestError:function(b){return a.reject(b)},response:function(c){return null!==c&&200===c.status&&b.sessionStorage.token&&!d.isAuthenticated&&(d.isAuthenticated=!0),c||a.when(c)},responseError:function(e){return null!==e&&401===e.status&&(b.sessionStorage.token||d.isAuthenticated)&&(delete b.sessionStorage.token,d.isAuthenticated=!1,c.path("/")),a.reject(e)}}});